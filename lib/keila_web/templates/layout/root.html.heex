<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <%= csrf_meta_tag() %>
    <title>
      <%= get_meta(
        @conn,
        view_module(@conn),
        view_template(@conn),
        :title,
        gettext("Pigeon Newsletter Service")
      ) <> " · Pigeon" %>
    </title>
    <meta property="og:description" content="Pigeon — self-hosted email newsletter platform." />
    <meta property="og:image" content={Routes.static_url(@conn, "/images/pigeon_og.png")} />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="theme-color" content="#111827" />
    <link rel="icon" type="image/png" href={Routes.static_path(@conn, "/pigeon-favicon.png")} />
    <link rel="manifest" href={Routes.static_path(@conn, "/site.webmanifest")} />
    <link phx-track-static rel="stylesheet" href={Routes.static_path(@conn, "/css/app.css")} />
    <script
      defer
      phx-track-static
      type="text/javascript"
      src={Routes.static_path(@conn, "/js/app.js")}
    >
    </script>
  </head>
  <%= if @current_user do %>
    <body class={["min-h-screen bg-[color:var(--page-bg)]", ui_refresh_class()]}>
      <div id="app" class="min-h-screen">
        <!-- Sidebar: fixed, non-scrolling -->
        <aside class="fixed inset-y-0 left-0 w-64 overflow-y-auto bg-slate-900 text-white">
          <%= render("_menu.html", assigns) %>
        </aside>
        <!-- Content: scrollable area with left margin equal to sidebar width -->
        <main class="ml-64 min-h-screen">
          <div class="page-container">
            <%= @inner_content %>
            <%= render("_footer.html", assigns) %>
          </div>
        </main>
      </div>
    </body>
  <% else %>
    <body class={["min-h-screen bg-[color:var(--page-bg)]", ui_refresh_class()]}>
      <div id="app" class="min-h-screen">
        <%= render("_menu.html", assigns) %>
        <div class="page-container">
          <%= @inner_content %>
          <%= render("_footer.html", assigns) %>
        </div>
      </div>
    </body>
  <% end %>
</html>
